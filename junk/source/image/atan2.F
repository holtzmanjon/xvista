#include "Vista.h"

	SUBROUTINE DOATAN2(A,IMSR,IMER,IMSC,IMEC,B,JMSR,JMER,JMSC,JMEC)

	REAL A(IMSC:IMEC,IMSR:IMER), B(JMSC:JMEC,JMSR:JMER)
        LOGICAL KEYCHECK
#ifdef VMS
	INCLUDE 'VINCLUDE:VISTALINK.INC'
#else
	INCLUDE 'vistadisk/source/include/vistalink.inc'
#endif

	IF (.NOT. KEYCHECK()) THEN
	  XERR = .TRUE.
	  RETURN
	END IF

	IF (IMSR .NE. JMSR .OR. IMER .NE. JMER .OR.
     &      IMSC .NE. JMSC .OR. IMEC .NE. JMEC) THEN
	  PRINT *, 'Images must be of the same size for ATAN2'
	  XERR = .TRUE.
	  RETURN
	END IF

	CONV = 180./ABS(ACOS(-1.))
	DO 5501 J = JMSR, JMER
	  DO 5502 I = IMSC, IMEC
	    
	    A(I,J) = ATAN2(A(I,J),B(I,J))*CONV

5502      CONTINUE
5501    CONTINUE

	RETURN
	END
